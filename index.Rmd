---
title       : Roma province population by town
subtitle    : Developing Data Products
author      : Max Testa
job         : Data science learner
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : github        # 
widgets     : []            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
knit        : slidify::knit2slides
runtime     : shiny
logo        : pvroma.jpg
---

## Summary

The project developed an interactive R web [application](https://maxmax65.shinyapps.io/DataProductProject) implemented using a very powerful tool: [Shiny](http://shiny.rstudio.com/) by dr. Ramnath Vaidyanathan.

The application shows the trend of Roma province population from 2002 to 2011 giving the user the possibility to select one of the 121 towns/cities of the province and whether to present either the total numbers of Female and Male, or only the numbers related to one of the two sexes.

The file with the population of Rome province is retrieved from the [Italian Government open data repository](http://www.dati.gov.it/dataset).

The R object with the boundaries of Italian "Comuni" (level 3 map of Italy) is downloaded from the [GADM database](http://gadm.org/download)

--- .class #id 

## The data

```{r kable, echo=FALSE}
filename<-"../DataProductProject/PopolazionePerComuneEdAnno.csv"; PopEtaAnno<-read.csv(filename, stringsAsFactors = FALSE);
cat("The dataset 'PopEtaAnno' with population information has dimension: ", dim(PopEtaAnno)[1]," x ", dim(PopEtaAnno)[2])
kable(summary(PopEtaAnno[, c(2,4:6)]),format = "html",caption = "'PopEtaAnno' dataset short summary")
```


The Roma province map is obtained from the whole Italy Level3 map subsetting with NAME_3=="Roma"; some cleansing is then performed to align the content of "NAME_3" variable of the "ProvRM" map object to the one of corresponding "Comune" variable in population dataset; then the "ProvRM" object is saved as "ProvRM_map.RDS" using saveRDS() function


--- .smallcode #id 

## The power of shiny (1/2)

The shinyUI component uses fluidPage() instruction to make the sidebar and the mainbar elements adaptable to the browser window.

Via sidebar instructions the user is asked to select the town (identified as "input$town") and/or the type of information (identified as "input$M_F_MF") to display: the default choices are on "Roma", the Italian capital, and on "Male+Female".
The mainbar's only instruction calls the funzione plotOutput() that displays the barplot and the map produced by the shinyServer component.

The shinyServer component loads the data and, based on the inputs collected by the UI, prepares the appropriate information, rendered and presented by the UI.

--- .class #id 

## The power of shiny (2/2)

This is a simplified excerpt of the ui.R code that selects the information used by the server.R to prepare the appropriate plot to present as output  through the ui.R.


```{r, echo=FALSE, cache=FALSE}
library(shiny)
PopEtaAnno<-read.csv("../DataProductProject/PopolazionePerComuneEdAnno.csv", stringsAsFactors = FALSE)
towns<-sort(unique(PopEtaAnno$Comune))
rm(PopEtaAnno)

shinyUI(fluidPage(
    titlePanel("Population of Roma province"),
    sidebarLayout(
        sidebarPanel("Select the type of info and/or the town you are interested in",
            br(),
            br(),
            radioButtons("M_F_MF", label="Choose the info to show:",
                        choices = c("Female", "Male", "Male+Female"),
                        select="Male+Female"),
            selectInput("town",
                        label = "Choose a town to display",
                        choices = towns,
                        selected = towns[1])
        ),
        mainPanel()
    )
))
